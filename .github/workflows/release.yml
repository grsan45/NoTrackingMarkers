name: build-release
on: [push]
jobs:
  build-release:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v4
      - uses: TheMrMilchmann/setup-msvc-dev@v3
        with:
          arch: x64

      - uses: lukka/get-cmake@latest

      - name: Setup vcpkg
        uses: lukka/run-vcpkg@v11

      - name: Run cmake build
        uses: lukka/run-cmake@v10
        with:
          configurePreset: 'useVcpkg'
          configurePresetAdditionalArgs: "['-DCMAKE_BUILD_TYPE=Release']"

          buildPreset: 'vcpkg-build'

      - name: Create Release
        uses: softprops/action-gh-release@v2
        if: github.ref_type == 'tag'
        with:
          files: 'build/NoTrackingMarkers.exe'